name: "Open Pull Request"
description: "Create a pull request on GitHub."
author: "AgentSprint"

inputs:
  owner:
    description: "GitHub repository owner"
    required: true
  repo:
    description: "GitHub repository name"
    required: true
  title:
    description: "Pull request title"
    required: true
  body:
    description: "Pull request body (Markdown supported)"
    required: true
  head:
    description: "The name of the branch where your changes are implemented"
    required: true
  base:
    description: "The name of the branch you want the changes pulled into"
    required: true
  token:
    description: "GitHub token (optional). Omit to use the caller's GITHUB_TOKEN."
    required: false
    default: ""


runs:
  using: "composite"
  steps:
    - name: pull request open
      shell: bash
      env:
        AUTH_TOKEN: ${{ inputs.token != '' && inputs.token || github.token }}
      run: |
        set -euo pipefail
        curl -L \
          -X POST \
          -H "Accept: application/vnd.github+json" \
          -H "Authorization: Bearer ${AUTH_TOKEN}" \
          -H "X-GitHub-Api-Version: 2022-11-28" \
          https://api.github.com/repos/${{ inputs.owner }}/${{ inputs.repo }}/pulls \
          -d '{"title":"${{ inputs.title }}","body":"${{ inputs.body }}","head":"${{ inputs.head }}","base":"${{ inputs.base }}"}'